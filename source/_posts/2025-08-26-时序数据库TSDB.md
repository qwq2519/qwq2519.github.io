---
title: 时序数据库TSDB
date: 2025-08-26 09:34:32
tags:
  - 数据库
---

# 是什么

时序数据库（TSDB）是一种**专门用于存储、管理和分析 “时间序列数据”** 的数据库系统。

所谓 “时间序列数据”，是指按时间顺序持续产生的、与时间强关联的结构化数据（例如每秒钟的温度读数、每分钟的服务器 CPU 使用率、每小时的用户访问量等），其核心特征是 “时间戳（Timestamp）+ 数值 / 状态” 的键值对结构。

时序数据几乎都是按时间顺序抵达，并且需要实时处理，事后几乎不会处理了。需要不断往数据库插入。

追踪这些数据，进行变化，趋势分析，是很有价值的。



# 适用场景

## 时序数据特点（TSDB设计依据）

- **时间有序性**：数据严格按时间戳递增生成，写入顺序与时间顺序一致（极少出现乱序）；
- **高频写入与海量存储**：通常以秒、毫秒为单位持续产生数据（例如工业传感器每秒采集 1 次数据，互联网服务每秒产生数万条日志）；
- 海量存储：
- 按时间查询
-  **写多读少**：写远远多于写入，且多为追加写，修改写少。  读取多为“时间范围+标签筛选”类型的读
-  标签：除了时间戳和数值，数据还可以携带多维度标签。
-  数据生命周期明确：时序数据价值随时间衰减。久一点的数据基本无需实时查询，可以归档压缩，甚至删除。



## TSDB特点



传统关系型数据库（如 MySQL）或通用 NoSQL 数据库（如 MongoDB）虽能存储数据，但存在明显短板：

- 高频写入时性能瓶颈（传统数据库事务机制冗余，无法支撑每秒数万条的时序数据写入）；
  - 需要支持事务什么的
- 海量数据存储成本高（时序数据通常需长期保留，传统数据库压缩率低，占用存储空间大）；
  - 比如mysql的记录就有一些隐藏字段，比如trx_id，rollback_ptr等
- 时间维度查询效率低（传统数据库索引未针对 “按时间范围筛选” 优化，查询历史数据时耗时久）。
  - mysql存储复杂的结构化数据，需要支持多表联查等复杂查询


而 TSDB 通过**针对性的存储结构、索引设计和查询优化**，完美解决上述问题，成为处理时序数据的 “专用工具”。

mysql这种关系型数据库是基于关系代数设计，二维表（还有主键，外键等)，而TSDB是时序模型(时间戳，数据，标签)

多数TSDB采用列存储而非mysql的行存储，将时间戳列和数值列分开存储，如果要按照时间顺序聚合计算数值，可以批量读取数据列的数据，而非等待其他无用列，减少磁盘IO，而MySQL就需要读取每行所有字段，再提取目标列，IO效率低。



- 高效写入机制：应对高频追加写（删除也很方便）

  - 无事务，轻事务设计：时序数据写入后基本不修改，因此省去传统事务的修改和删除的冗余的校验，仅保证原子写入
  - 批量写入，可以支持无序写入，写入后会自动排序等
  - 内存缓冲写入：内存缓冲区，然后再批量刷盘

- 针对性存储和压缩：降低海量存储成本

  - 时间戳压缩：时序数据的时间戳都是连续递增的，可以针对这个特性，不需要存储所有完整的时间戳，仅存储（起始时间，间隔，偏移量）来压缩。
  - 数值压缩：时序数据的数值一般是连续性的，可以采用差分编码，浮点数压缩等算法。
  - 分层存储：根据数据生命周期划分冷热温，存储在不同介质，便于快速，常规，压缩归档，平衡性能与成本

- 时间友好索引：加速时间范围查询

  - 标签索引: 时序数据查询一般就是“标签+时间范围”，可以针对某个标签专门建立索引，快速查询。底层一般使用跳表或者哈希表
  - 时间序列索引：针对一条完整的时间序列（一个数据源所有数据）建立索引，先定位到序列再按照时间范围读取数据

- 时序化查询：TSDB专门为时序分析设计，提供了独有的语法

- 高可用，可扩展：分布式架构，自动分片，副本，水平扩展,自动分区等

  



## 应用场景

- 服务器，容器，微服务等基本信息的日志记录
- 物联网平台
- 金融与交易
