---
title: 零散八股，面试题记录
date: 2025-09-10 17:00:05
tags:
---



# 数据库

1. redis为什么先写命令然后再写到AOF文件中，而不是采用WAL机制
WAL（Write-Ahead Logging，预写日志）:先写日志到磁盘并且刷盘成功，事务才能执行内存中的数据页更新，数据页的磁盘写入可以延后批量处理。

- 日志写入是顺序IO，而数据页写入是随机IO。将数据页随机写优化为 日志顺序写和后续数据页批量刷盘，提升IO性能。
- 事务更改了内存数据页，但是未成功刷盘，会导致修改丢失，违反ACID的持久性。而WAL可以在崩溃后重做已提交的事务，回滚未提交的事务，保证原子性持久性。

但是Redis的核心定位是高性能内存数据库
- Redis的写命令是内存操作，写AOF文件是磁盘操作。先写AOF再执行命令会导致内存操作等待磁盘IO。
- AOF文件的作用是记录执行成功的命令用来回复，是事后日志，而非WAL(记录待执行的操作)。Redis应该有其他的重试机制，如果失败了也不需写入AOF

当然，AOF可能存在风险（命令执行成功后但是AOF写入前，Redis宕机），这就就是AOF刷盘策略的问题了，要在性能和数据安全之间平衡。AOF的缓冲区就是这样的。

并且Redis还要检查命令格式是否正确。